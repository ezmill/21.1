function extractToken(e){var t=e.match(/access_token=(\w+)/);return!!t&&t[1]}function imgurUpload(){var e=canvas.toDataURL();var t=e.substring(e.indexOf(",")+1,e.length);var n;authorization="Client-ID "+clientId;$.ajax({url:"https://api.imgur.com/3/image",method:"POST",headers:{Authorization:authorization,Accept:"application/json"},data:{image:t,type:"base64"},success:function(e){h1.style.display="none";console.log(e.data.link);var t=document.createElement("a");t.className+="btn half btn-positive btn-outlined";t.innerHTML="Link to Image";t.href=e.data.link;var n=document.createElement("a");n.className+="btn half btn-negative btn-outlined";n.innerHTML="Sort Stream";n.href="http://ezra.io/social.html";if(document.getElementById("range-div")){appender.insertBefore(t,document.getElementById("range-div"));appender.insertBefore(n,document.getElementById("range-div"))}else{appender.innerHTML="";appender.appendChild(t);appender.appendChild(n)}var r={_id:(new Date).toISOString(),link:e.data.link};db.put(r,function(t,n){if(!t){console.log("Successfully added a link!")}})}})}function showLinks(){}function redrawLinksUI(e){var t=document.getElementById("link-list");t.innerHTML="";e.forEach(function(e){t.appendChild(createLinkListItem(e.doc))})}function createLinkListItem(e,t){var n=document.createElement("li");n.innerHTML=e.link;return n}function sync(){var e={live:false,complete:console.log("sync error")};db.replicate.to(remoteCouch,e,function(e,t){if(e){console.log(e)}})}var clientId="a2d315bf8c5119a";var $imgurOauth=$("#share");var token=extractToken(document.location.hash);var remoteCouch="https://ezmill:mycoolpassword@ezmill.cloudant.com/ok/";var db=new PouchDB(remoteCouch);var appender=document.getElementById("params");db.info(function(e,t){db.changes({since:t.update_seq,live:false})});var h1=document.createElement("h1");h1.className+="title";h1.innerHTML="loading...";appender.appendChild(h1);h1.style.display="none";$("#share").click(function(){h1.style.display="block";imgurUpload()})